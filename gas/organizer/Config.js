/**
 * 設定ファイル
 * スプレッドシートIDとジャンル分類ルールを定義
 */

// ソーススプレッドシート（元データ）
const SOURCE_SPREADSHEET_ID = '18iKQSj8WpB90RvZtKuWd8KX_3Yj4JHx-eQYLgbNXynk';
const SOURCE_SHEET_NAME = '記録データ';

// ターゲットスプレッドシート（整理後データ）
// ※初回実行時に自動作成されます。作成後はここにIDを設定してください
const TARGET_SPREADSHEET_ID = '1Q4gMZe42XoPpqunh9OOxTPM2xIZvMYyfYoEZdfstfkI';

// ジャンル分類ルール
// ※優先度順（上から順にマッチング。より具体的なジャンルを先に配置）
// ※曖昧なキーワードは削除し、具体的なキーワードのみ使用
const GENRE_RULES = {
  // ========== 優先度：最高（具体的・専門的なキーワード）==========
  '投資・金融': [
    // 投資全般
    '投資', '株式', 'FX', '仮想通貨', 'NISA', '資産運用', '投機', 'トレード',
    '資産形成', 'ナスダック', 'SP500', '金融', '投資信託', '新NISA', 'つみたてNISA',
    // 株式関連
    '米国株', '日本株', '配当', 'ETF', 'インデックス', '決算', '株価', '銘柄',
    '高配当', 'グロース株', 'バリュー株', 'IPO', '信用取引',
    // 経済指標
    '経済指標', '雇用統計', 'CPI', 'FOMC', '金利', 'インフレ', 'GDP',
    // 仮想通貨
    'ビットコイン', 'BTC', 'イーサリアム', '暗号資産', 'NFT'
  ],
  'AI・テクノロジー': [
    // AI関連（具体的なサービス名）
    'ChatGPT', '生成AI', 'Gemini', 'Claude', 'GPTs', 'Copilot', 'Midjourney',
    'Stable Diffusion', 'DALL-E', 'Perplexity', 'NotebookLM',
    // AI活用
    'プロンプト', 'AIアート', 'AI画像', 'AIイラスト', 'AI副業', '画像生成AI',
    // AI自動化ツール
    'Notion', 'Zapier', 'Make', 'GAS', '自動化', 'n8n', 'Google Apps Script', 'Skills',
    // 開発
    'Vibe Coding', 'プログラミング', 'コーディング', 'Python', 'JavaScript',
    'エンジニア', 'Web開発', 'アプリ開発', 'ノーコード', 'ローコード'
  ],
  // ========== 優先度：高 ==========
  '副業・稼ぎ方・note': [
    // 副業関連
    '副業', '収益化', 'せどり', '転売', 'アフィリエイト', '在宅ワーク',
    '副業初心者', 'フリーランス', '複業', 'ネット副業', '不労所得',
    // note/Threads特化
    'note収益', 'note販売', 'note初心者', 'Threads運用', 'Threads攻略',
    'スレッズ',
    // ライティング・文章術
    'ライティング', 'コピーライティング', '文章術', 'タイトル術', 'セールスライティング',
    'Webライター', 'ライター',
    // デザイン副業
    'Canva', 'Figma', 'デザイン副業', 'バナー作成', 'LINEスタンプ',
    // 写真編集・プリセット販売
    'Lightroom', 'プリセット', 'LUT', '写真編集', 'RAW現像'
  ],
  '恋愛・マッチングアプリ': [
    // マッチングアプリ
    'マッチングアプリ', 'ペアーズ', 'Tinder', 'with', 'Omiai', 'タップル',
    // 恋愛全般
    '恋愛', 'モテ', 'デート', 'マッチング', '婚活', '復縁', '片思い', '失恋',
    '告白', 'プロポーズ', '既読スルー', 'LINE恋愛', '遠距離恋愛',
    // 夫婦・パートナー
    '同棲', '年の差', '夫婦関係', '離婚', '再婚', '浮気', '不倫',
    '恋愛心理学', '蛙化現象', 'ハイスペ', '彼氏', '彼女', '結婚',
    // 夫婦関係改善
    'セックスレス', 'レス', '夫婦関係改善'
  ],
  // ========== 優先度：中 ==========
  'ビジネス・マーケティング': [
    // マーケティング
    'マーケティング', '集客', 'セールス', 'コンサル', 'BtoB', 'BtoC',
    'SNSマーケティング', 'コンテンツマーケ', 'ブランディング', 'LP', 'CV',
    // 起業・経営
    '起業', '経営', '事業', '独立', '個人事業', '法人化', '売上'
  ],
  'SNS運用': [
    // プラットフォーム別
    'X運用', 'Twitter運用', 'Instagram運用', 'インスタ運用', 'TikTok運用',
    'YouTube運用', 'リール', 'ショート動画',
    // 運用テクニック
    'フォロワー増', 'インプレッション', 'エンゲージメント', 'バズ', 'ツイート術',
    'いいね', 'リツイート', 'アルゴリズム',
    // YouTube収益化・動画編集
    'YouTube収益化', '動画編集', 'CapCut', 'Shorts', 'YouTubeサムネ', 'サムネ',
    'Premiere', 'DaVinci', '動画クリエイター'
  ],
  '占い・スピリチュアル': [
    // 占い
    '占い', 'タロット', '星座占い', '手相', '四柱推命', '算命学', '数秘術',
    '星座', '12星座', '獅子座', '乙女座', '天秤座', '蠍座', '射手座',
    '山羊座', '水瓶座', '魚座', '牡羊座', '牡牛座', '双子座', '蟹座',
    // スピリチュアル
    'スピリチュアル', '運勢', '風水', 'ツインレイ', 'ツインソウル',
    '引き寄せの法則', 'アファメーション', '波動', 'パワーストーン', 'オーラ',
    '一粒万倍日', '天赦日', '開運', '守護霊', 'チャクラ', '浄化'
  ],
  '心理学・メンタル': [
    // 心理学
    'MBTI', 'HSP', '心理学', '性格診断', '自己分析', '認知行動療法', 'アドラー',
    // メンタルケア
    'メンタルヘルス', '自己肯定感', 'アサーション', '愛着スタイル', '境界線',
    'ストレス解消', '不安解消', 'うつ', '適応障害', 'バーンアウト', '燃え尽き'
  ],
  '子育て・育児': [
    // 妊娠・出産
    '妊娠', '出産', 'つわり', '出産準備', '産後ケア', '産後うつ', '産後クライシス',
    // 0歳・新生児
    '赤ちゃん', '新生児', '夜泣き', '背中スイッチ', '寝かしつけ', 'ネントレ',
    '授乳', '母乳', 'ミルク', '混合', '離乳食', '吐き戻し',
    // 幼児
    'イヤイヤ期', '癇癪', 'トイトレ', 'おむつはずし', '偏食', '好き嫌い',
    // 保活・園生活
    '保活', '保育園', '幼稚園', '慣らし保育', '保育園 洗礼', '入園準備',
    // 小学生
    '小1の壁', '学童', '入学準備', '宿題', '習い事',
    // 受験
    '中学受験', '高校受験', '大学受験', '受験勉強', '偏差値', '塾', '模試',
    'SAPIX', 'サピックス', '早稲アカ', '四谷大塚', '日能研', '受験ノート', '受験親',
    // 発達・特性
    '発達障害', '発達グレー', 'ASD', 'ADHD', 'HSC', '療育', '児童発達支援',
    '行き渋り', '登園しぶり', '不登校',
    // 働き方
    'パパ育休', '男性育休', '育休', 'ワンオペ', '共働き', '時短勤務',
    // グッズ・テック
    'ベビーテック', '育児グッズ', '抱っこ紐', 'ベビーカー', 'チャイルドシート',
    // その他
    '子育て', '育児', '育児ストレス', '孤独育児', 'ママ友'
  ],
  // ========== 優先度：低（広いカテゴリ）==========
  '健康': [
    // ダイエット・ボディメイク
    'ダイエット', '筋トレ', '減量', 'ボディメイク', '糖質制限', 'ファスティング',
    // 体調管理
    '腸活', '便秘', 'むくみ', '冷え性', '疲労回復', '自律神経', '血糖値',
    // 睡眠
    '睡眠', '不眠', '快眠', '睡眠の質',
    // 女性特有
    'PMS', '生理痛', '更年期', '妊活', 'ホルモンバランス'
  ],
  '美容': [
    // スキンケア
    '美容', 'スキンケア', '毛穴', 'ニキビ', 'シミ', 'シワ', 'たるみ', 'くすみ',
    '乾燥肌', '敏感肌', '美白', '保湿', 'エイジングケア',
    // 成分・アイテム
    'レチノール', 'ビタミンC', 'セラミド', 'ナイアシンアミド', '日焼け止め',
    // メイク・コスメ
    'メイク', 'コスメ', '韓国美容', 'デパコス', 'プチプラ',
    // 診断系
    'パーソナルカラー', '骨格診断', '顔タイプ', '垢抜け', 'イメチェン'
  ],
  'キャリア・転職': [
    // 転職
    '転職', '転職活動', '転職エージェント', '中途採用', '未経験転職',
    // 就活
    '就活', '新卒', '面接', '履歴書', '職務経歴書', 'ES', 'エントリーシート',
    // キャリア
    'キャリア', 'キャリアプラン', '年収交渉', '昇進', '昇給',
    // 働き方
    'フルリモート', 'リモートワーク', 'ワーママ', '退職代行', '退職',
    '自己PR', '志望動機', '適職', 'リスキリング', '資格',
    // 資格・学習
    'TOEIC', '英語学習', '簿記', 'FP資格', '資格勉強', '宅建', '勉強法', '独学',
    '英会話', '資格取得'
  ],
  'その他': [] // キーワード不要（デフォルト分類）
};

// 著者別の強制分類ルール（タグ・タイトルより優先）
const AUTHOR_RULES = {
  '投資・金融': [
    'バフェット太郎',
    '広瀬隆雄',
  ],
  '副業・稼ぎ方・note': [
    'ひな姫',  // ひな姫💖｜notePRO認証｜note大学運営...
    'Sai',
    'たこすけ',
    'ぱくちゃ',
    'ライ|@Threads',  // ライ|@Threads×noteノウハウコレクターを卒業させる猫
    'あわを。',
    'mimiちゃん',
    'しちゃうおじさん',  // しちゃうおじさん🐤
    'おきるママ',
  ],
  'その他': [
    // 著名人・評論家・作家など（専門ジャンル外）
    '山口周',
    '飯山陽',
    'ロザン菅',
    // プロ野球選手
    '郡司裕也', '郡司 裕也',
    '長谷川信哉', '長谷川 信哉',
    // 麻雀・カードゲーム・プロレス系
    '近代麻雀ノート',
    'ゆうせー',
    '男色ディーノ',
    'Dropkick',
    '大日本プロレス',
    // スポーツ・エンタメ
    'Reona Takenaka',
    '赤塚康太',
    // その他
    'nen88844',
    'まっすー',
    '散見',
    'ロリィタ族',
  ],
};

// ジャンル判定の優先順序（上から順にマッチング）
const GENRE_PRIORITY = [
  '投資・金融',
  'AI・テクノロジー',
  '副業・稼ぎ方・note',
  '恋愛・マッチングアプリ',
  'ビジネス・マーケティング',
  'SNS運用',
  '占い・スピリチュアル',
  '心理学・メンタル',
  '子育て・育児',
  '健康',
  '美容',
  'キャリア・転職',
  'その他'
];

// 列のインデックス（0始まり）
const COLUMNS = {
  RECORD_DATE: 0,      // A列: 記録日時
  CREATE_DATE: 1,      // B列: 作成日
  TITLE: 2,            // C列: タイトル
  AUTHOR: 3,           // D列: 著者
  AUTHOR_URL: 4,       // E列: 著者URL
  URL: 5,              // F列: URL（一意キー）
  LIKES: 6,            // G列: スキ数
  HIGH_EVAL: 7,        // H列: 高評価数
  PRICE: 8,            // I列: 価格
  TAG: 9,              // J列: タグ
  SALES_CLAIM: 10,     // K列: 販売主張
  PURCHASED_24H: 11,   // L列: 24h購入確認
  ELAPSED_DAYS: 12,    // M列: 経過日数
  MIN_REVENUE: 13,     // N列: 最低売上推定
  PURCHASE_RATE: 14,   // O列: 購入者率(%)
  PROCESSED: 15        // P列: 処理済みフラグ
};

// 出力開始列・終了列（A列からO列）
const OUTPUT_START_COL = 0; // A列（記録日時を含める）
const OUTPUT_END_COL = 14;  // O列
